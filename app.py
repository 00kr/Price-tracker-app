import requests
from bs4 import BeautifulSoup

# List of products to track
products_to_track = [
    {
        "product_URL": "https://www.snapdeal.com/product/indus-valley-disposable-face-mask/638539148385",
        "name": "Lives Disposable Face Mask with Nose Pin - Pack Of 50pc",
        "target_price":500
    },
   {
        "product_URL": "https://www.snapdeal.com/product/9lives-4-ply-cloth-face/642056364781#bcrumbSearch:face%20mask",
        "name": "Brown soft layered mask",
        "target_price":171
   },
   {
       "product_URL":"https://www.snapdeal.com/product/9lives-4-ply-cloth-face/636964955724#bcrumbSearch:face%20mask",
       "name":"4 Ply Cotton Face Mask Pack of 2",
       "target_price":170
   },
  {
      "product_URL":"https://www.snapdeal.com/product/9lives-3-ply-disposable-masks/671992408577#bcrumbSearch:face%20mask",
      "name":"3 Ply Anti Viral, Anti Pollution Surgical Disposable Face Mask With Nose Pin- Pack of 100 (Check Print)",
      "target_price":223

  },
  {
      "product_URL":"https://www.snapdeal.com/product/anekaant-blue-cotton-mask-pack/652691557621#bcrumbSearch:face%20mask",
      "name":"Anekaant - Blue Cotton Mask ",
      "target_price":84

  }

]

def give_products_price(product_URL):
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36"
    }
    page = requests.get(product_URL, headers=headers)
    soup = BeautifulSoup(page.content, 'html.parser')

    # Try to find the product price
    product_price = soup.find(itemprop="price")
    if product_price is None:
        product_price = soup.find(id="finalExchPrice")

    # Return the price text if found
    return product_price.get_text().strip() if product_price else None

result_file=open('my_result-file.txt','w')
try:

# Process each product in the list
  for every_product in products_to_track:
    product_price_returned = give_products_price(every_product.get("product_URL"))

    if product_price_returned:
        print(product_price_returned + " - " + every_product.get("name"))

        # Process the price to remove currency symbol and commas
        my_product_price = ''.join(filter(str.isdigit, product_price_returned))  # Extract numbers only
        my_product_price = int(my_product_price)  # Convert to integer

        # Check against target price
        if my_product_price < every_product.get("target_price"):
            result = f"{every_product.get('name')} - Available at target price; Current price: {my_product_price}\n"
            print("Available at your required price")
        else:
            result = f"{every_product.get('name')} - Still at current price; Current price: {my_product_price}\n"
            print("Still at current price")

    else:
        result = f"Price not found for {every_product.get('name')}\n"
        print("Price not found for " + every_product.get("name"))
    result_file.write(result)
finally:
      result_file.close()



















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































